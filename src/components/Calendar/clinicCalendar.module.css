.calendar {
  --cal-border: var(--color-card-border, #e6e6e6);
  --cal-muted: var(--color-muted, #6B7280);
  --cal-primary: var(--color-primary, #2E7D6D);
  --cal-primary-hover: var(--color-primary-hover, #399b87);

  height: 100%;
  min-height: calc(100vh - var(--nav-h));
  display: flex;
  flex-direction: column;

  /* <<< reativamos o scroll vertical do calendário >>> */
  overflow-y: auto;
  overflow-x: hidden;
}

/* Header */
.header {
  margin-bottom: var(--space-3);
  gap: var(--space-3);
  flex: 0 0 auto;
  background: transparent; /* evita ‘colar’ quando rola */
}
.viewSwitch { display: inline-flex; gap: .4rem; }

/* ===== Month grid ===== */
.gridMonth {
  flex: 1 0 auto;
  display: grid;

  grid-template-columns: repeat(7, 1fr);
  grid-template-rows: auto repeat(6, 1fr);

  gap: 2px;
  border-top: 1px solid var(--cal-border);
  border-left: 1px solid var(--cal-border);
  background: #fff;
  border-radius: var(--radius-md);
  overflow: hidden;
}

.dayHeader {
  background: color-mix(in oklab, var(--cal-primary), white 92%);
  color: var(--color-text);
  padding: .5rem;
  border-right: 1px solid var(--cal-border);
  border-bottom: 1px solid var(--cal-border);
  font-weight: 700;
  text-align: center;
}

.day {
  position: relative;
  background: #fff;
  border-right: 1px solid var(--cal-border);
  border-bottom: 1px solid var(--cal-border);
  padding: .25rem;
}
.dayNumber { font-weight: 700; font-size: .95rem; color: var(--color-text); }
.eventsStack { display: grid; gap: .25rem; margin-top: .25rem; }

.eventPill {
  border-color: var(--cal-primary);
  background: color-mix(in oklab, var(--cal-primary), white 85%);
  padding: .25rem .5rem !important;
  font-size: .85rem !important;
}
.eventTitle { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--color-text); }
.eventDot { width: .55rem; height: .55rem; border-radius: 50%; display: inline-block; }

.moreCount { font-size: .85rem; color: var(--cal-muted); padding: .1rem .2rem; }

.today {
  outline: 2px solid color-mix(in oklab, var(--cal-primary), white 40%);
  outline-offset: -2px;
  background: color-mix(in oklab, var(--cal-primary), white 97%);
}
.otherMonth { background: #fafafa; color: #777; }

/* ===== Week grid ===== */
.gridWeek {
  flex: 1 0 auto;
  display: grid;

  grid-template-columns: 80px repeat(7, 1fr);
  grid-template-rows: auto 1fr;

  border: 1px solid var(--cal-border);
  border-radius: var(--radius-md);
  overflow: hidden;
  background: #fff;
}

.timeColHeader { grid-column: 1 / 2; grid-row: 1; background: #fff; border-bottom: 1px solid var(--cal-border); }
.dayColHeader  { grid-column: auto; grid-row: 1; background: color-mix(in oklab, var(--cal-primary), white 92%); border-left: 1px solid var(--cal-border); border-bottom: 1px solid var(--cal-border); }
.dayNameRow { display:flex; align-items:center; justify-content:space-between; padding:.5rem .6rem; }
.dayName { font-weight:700; }
.dayBadge { display:inline-grid; place-items:center; min-width:1.8rem; height:1.8rem; border-radius:999px; background:#fff; border:1px solid var(--cal-border); font-weight:700; }
.todayBadge { background: var(--cal-primary); color:#fff; border-color: var(--cal-primary); }

.timeCol {
  grid-column: 1 / 2;
  grid-row: 2;
  display: grid;
  grid-template-rows: repeat(var(--hours, 12), 1fr);
  align-content: stretch;
}
.hourRow { border-bottom: 1px dashed var(--cal-border); display:flex; align-items:flex-start; }
.hourLabel { font-size:.8rem; color:var(--cal-muted); padding:.25rem .5rem; }

.dayCol { grid-row: 2; position: relative; display: grid; grid-template-rows: repeat(var(--hours, 12), 1fr); border-left: 1px solid var(--cal-border); }
.hourTrack { border-bottom: 1px dashed var(--cal-border); opacity:.8; }
.dayColEvents { position: absolute; inset: .35rem .35rem .35rem .35rem; }

.eventBlock {
  position: absolute;
  left: .2rem; right: .2rem;
  border-left: 4px solid var(--cal-primary);
  background: color-mix(in oklab, var(--cal-primary), white 85%);
  border-radius: 8px;
  padding: .25rem .4rem;
  box-shadow: var(--shadow-sm);
  text-align: left;
}
.eventBlock:hover { filter: brightness(1.02); }
.eventBlockTitle { display:block; font-weight:700; font-size:.9rem; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; color:var(--color-text); }
.eventBlockMeta  { display:block; font-size:.8rem;  color:var(--cal-muted); overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* ===== Year grid (com scroll vertical do container) ===== */
.yearGrid {
  flex: 1 0 auto;
  display: grid;

  /* alturas intrínsecas — sem forçar 4 linhas iguais */
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-3);
  /* sem overflow aqui; quem rola é .calendar */
}

.miniMonth {
  border: 1px solid var(--cal-border);
  border-radius: var(--radius-md);
  background: #fff;
  overflow: hidden;
}
.miniHeader {
  background: color-mix(in oklab, var(--cal-primary), white 90%);
  padding: .5rem .6rem;
  font-weight: 700;
  border-bottom: 1px solid var(--cal-border);
}
.miniGrid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  padding: .35rem;
  gap: .15rem;
}
.miniHead { text-align: center; font-size: .75rem; color: var(--cal-muted); }
.miniCell {
  text-align: center;
  font-size: .85rem;
  padding: .25rem 0;
  border-radius: 8px;
  border: 1px solid transparent;
  background: #fff;
}
.miniCell:hover { background: color-mix(in oklab, var(--cal-primary), white 92%); }
.miniHasEvent { border-color: color-mix(in oklab, var(--cal-primary), #000 10%); }
.todayMini { outline: 2px solid color-mix(in oklab, var(--cal-primary), white 40%); }

/* Responsivo */
@media (max-width: 920px) {
  .yearGrid { grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 640px) {
  .yearGrid { grid-template-columns: 1fr; }
}